function load(t){d3.json(t,function(t){var e=t.log.entries;(e=e.map(function(t){return t.startedDateTime=new Date(t.startedDateTime).getTime(),t})).sort(function(t,e){return d3.descending(t.startedDateTime,e.startedDateTime)});var n=parseInt(Math.random()*colors.length);d3.select("body").style("background-color",colors[n]),update(e),legend(t)})}function update(t){var e=d3.min(t,function(t){return t.startedDateTime}),n=d3.max(t,function(t){return t.startedDateTime}),a=t[t.length-1].time,r=(h-2*padding)/t.length,d=d3.scaleLinear().domain([0,n-e+a]).range([1,w-2*padding]),i=g.selectAll("rect").data(t),o=i.enter().append("rect").attr("y",function(t,e){return e*r}).attr("x",function(t){var e=n-new Date(t.startedDateTime).getTime();return d(e)});i.merge(o).transition().delay(function(t,e){return 5*e}).attr("y",function(t,e){return e*r}).attr("x",function(t){var e=n-new Date(t.startedDateTime).getTime();return d(e)}).attr("height",r-1).attr("width",function(t){return d(t.time)}),i.merge(o),i.exit().remove()}function legend(t){var e=t.log.pages[0],n=/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:\/\n]+)/g.exec(e.title),a=new Date(e.startedDateTime),r=d3.timeFormat("%Y-%m");gtext.select(".cond").text(n[1]+" "+r(a)).attr("y",-62).attr("x",5).style("font-size",14)}var w=document.body.clientWidth,h=document.body.clientHeight,colors=["#CA0002","#3B5998","#FDB815","#004276","#222"],svg=d3.select("svg").attr("width",w).attr("height",h),padding=20,g=svg.append("g").attr("transform","translate("+padding+", "+padding+")"),gtext=svg.append("g").attr("transform","translate("+padding+","+(h-2*padding)+")");gtext.append("text").classed("cond",!0),gtext.append("text").text("HAR").attr("y",0).attr("x",0).style("font-size",80),gtext.append("text").text("ABSTRACTOR").attr("y",18).attr("x",1).style("font-size",19);var datasets=["2013/cnn","2017/cnn","2013/facebook","2017/facebook","2013/google","2017/google","2013/nytimes","2017/nytimes","2013/wikipedia","2017/wikipedia"],index=0;svg.on("click",function(){load("assets/data/"+datasets[index]+".json"),++index>datasets.length-1&&(index=0)}).dispatch("click");